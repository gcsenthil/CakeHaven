<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Order</title>
    <link rel="stylesheet" href="css/style.css" />
    <link
      rel="icon"
      href="./img/favicon.svg"
      sizes="any"
      type="image/svg+xml"
    />
    <script src="js/main.js" defer></script>
  </head>
  <body class="h-screen bg-gray-100">
    <header class="sticky top-0 z-10 bg-fuchsia-700 text-white">
      <section class="mx-auto flex max-w-6xl items-center justify-between p-4">
        <h1 class="text-3xl font-medium">
          <a href="index.html">üç∞ Cake Havens</a>
        </h1>
        <div>
          <button
            id="hamburger-button"
            class="relative h-8 w-8 cursor-pointer text-3xl md:hidden"
          >
            <!-- &#9776; -->
            <div
              class="absolute top-4 -mt-0.5 h-1 w-8 rounded bg-white transition-all duration-500 before:absolute before:h-1 before:w-8 before:-translate-x-4 before:-translate-y-3 before:rounded before:bg-white before:transition-all before:duration-500 before:content-[''] after:absolute after:h-1 after:w-8 after:-translate-x-4 after:translate-y-3 after:rounded after:bg-white after:transition-all after:duration-500 after:content-['']"
            ></div>
          </button>
          <nav class="hidden space-x-8 text-xl md:block" aria-label="main">
            <a href="index.html#delights" class="hover:opacity-90"
              >Our Delights</a
            >
            <a href="index.html#menu" class="hover:opacity-90">Menu</a>
            <a href="index.html#testimonials" class="hover:opacity-90"
              >Testimonials</a
            >
            <a href="index.html#contact" class="hover:opacity-90">Contact Us</a>
            <a href="order.html" class="hover:opacity-90">Order</a>
          </nav>
        </div>
      </section>
      <section
        id="mobile-menu"
        class="top-68 justify-center absolute hidden w-full origin-top animate-open-menu flex-col bg-black text-5xl"
      >
        <!-- <button class="text-8xl self-end px-6">
                &times;
            </button> -->
        <nav
          class="flex min-h-screen flex-col items-center py-8"
          aria-label="mobile"
        >
          <a href="index.html" class="w-full py-6 text-center hover:opacity-90"
            >Home</a
          >
          <a
            href="index.html#delights"
            class="w-full py-6 text-center hover:opacity-90"
            >Our Delights</a
          >
          <a
            href="index.html#menu"
            class="w-full py-6 text-center hover:opacity-90"
            >Menu</a
          >
          <a
            href="index.html#testimonials"
            class="w-full py-6 text-center hover:opacity-90"
            >Testimonials</a
          >
          <a
            href="index.html#contact"
            class="w-full py-6 text-center hover:opacity-90"
            >Contact Us</a
          >
          <a href="order.html" class="w-full py-6 text-center hover:opacity-90"
            >Order</a
          >
          <a
            href="index.html#footer"
            class="w-full py-6 text-center hover:opacity-90"
            >Legal</a
          >
        </nav>
      </section>
    </header>
    <main class="mx-auto max-w-6xl">
      <section
        id="contact"
        class="widescreen:section-min-height tallscreen:section-min-height my-8 scroll-mt-16 p-6"
      >
        <h2
          class="mb-6 text-center text-4xl font-bold text-slate-900 dark:text-white sm:text-5xl"
        >
          Order Form
        </h2>
        <form id="orderForm" method="POST">
          <!-- Customer Name -->
          <div class="mb-4">
            <label for="customerName" class="block text-gray-700 font-medium"
              >Customer Name</label
            >
            <input
              type="text"
              id="customerName"
              name="customerName"
              class="mt-1 p-2 w-full border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
              required
            />
          </div>

          <!-- Customer Email -->
          <div class="mb-4">
            <label for="customerEmail" class="block text-gray-700 font-medium"
              >Email</label
            >
            <input
              type="email"
              id="customerEmail"
              name="customerEmail"
              class="mt-1 p-2 w-full border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
              required
            />
          </div>

          <!-- Customer Phone -->
          <div class="mb-4">
            <label for="customerPhone" class="block text-gray-700 font-medium"
              >Phone</label
            >
            <input
              type="text"
              id="customerPhone"
              name="customerPhone"
              class="mt-1 p-2 w-full border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
              required
            />
          </div>

          <!-- Cake Type (Dropdown) -->
          <div class="mb-4">
            <label for="cakeType" class="block text-gray-700 font-medium"
              >Cake Type</label
            >
            <select
              id="cakeType"
              name="cakeType"
              class="mt-1 p-2 w-full border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
              required
            >
              <option value="" disabled selected>Select Cake Type</option>
              <option value="Chocolate">Chocolate</option>
              <option value="Vanilla">Vanilla</option>
              <option value="Red Velvet">Red Velvet</option>
              <option value="Carrot">Carrot</option>
              <option value="Lemon">Lemon</option>
            </select>
          </div>

          <!-- Cake Size (Dropdown) -->
          <div class="mb-4">
            <label for="cakeSize" class="block text-gray-700 font-medium"
              >Cake Size</label
            >
            <select
              id="cakeSize"
              name="cakeSize"
              class="mt-1 p-2 w-full border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
              required
            >
              <option value="" disabled selected>Select Cake Size</option>
              <option value="Small">Small</option>
              <option value="Medium">Medium</option>
              <option value="Large">Large</option>
              <option value="Extra Large">Extra Large</option>
            </select>
          </div>

          <!-- Delivery Date -->
          <div class="mb-4">
            <label for="deliveryDate" class="block text-gray-700 font-medium"
              >Delivery Date</label
            >
            <input
              type="date"
              id="deliveryDate"
              name="deliveryDate"
              class="mt-1 p-2 w-full border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
              required
            />
          </div>

          <!-- Special Instructions -->
          <div class="mb-4">
            <label
              for="specialInstructions"
              class="block text-gray-700 font-medium"
              >Special Instructions</label
            >
            <textarea
              id="specialInstructions"
              name="specialInstructions"
              class="mt-1 p-2 w-full border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
              rows="4"
            ></textarea>
          </div>

          <!-- Submit Button -->
          <button
            type="submit"
            class="w-full bg-blue-500 text-white py-2 px-4 rounded-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500"
          >
            Submit
          </button>
        </form>

        <!-- Success Message -->
        <div
          id="successMessage"
          class="fixed top-[4rem] left-0 right-0 mt-4 mx-auto w-full max-w-lg bg-green-500 text-white text-center p-4 rounded-md shadow-lg hidden"
        >
          Order has been successfully submitted!
        </div>

        <div id="successMessage" class="hidden text-green-500 mt-4">
          Order has been successfully submitted!
        </div>
      </section>

      <script>
        document
          .getElementById("orderForm")
          .addEventListener("submit", async function (event) {
            event.preventDefault(); // Prevent form from submitting the traditional way

            // Collect form data
            const formData = {
              customerName: document.getElementById("customerName").value,
              customerEmail: document.getElementById("customerEmail").value,
              customerPhone: document.getElementById("customerPhone").value,
              cakeType: document.getElementById("cakeType").value,
              cakeSize: document.getElementById("cakeSize").value,
              deliveryDate: document.getElementById("deliveryDate").value,
              specialInstructions: document.getElementById(
                "specialInstructions"
              ).value,
              orderStatus: "Pending", // Default value
            };

            console.log("Form Data:", JSON.stringify(formData));

            try {
              // Send POST request using Fetch API
              const response = await fetch(
                "https://cakehaven.azurewebsites.net/api/PostOrder",
                {
                  method: "POST",
                  headers: {
                    "Content-Type": "application/json",
                  },
                  body: JSON.stringify(formData),
                }
              );

              // Handle response
              if (response.ok) {
                // If successful, show success message
                const data = await response.json(); // Assuming the server sends JSON back
                console.log("Server response:", data);

                // Display success message
                document
                  .getElementById("successMessage")
                  .classList.remove("hidden");
                document.getElementById("orderForm").reset(); // Reset the form after submission
              } else {
                // Handle errors (e.g., validation or server error)
                const errorData = await response.json(); // Assuming the server sends error details
                console.error("Error:", errorData);

                // Display error message
                alert(
                  "There was an issue with your order: " +
                    (errorData.message || "Please try again later.")
                );
              }
            } catch (error) {
              // Handle network or fetch errors
              console.error("Request failed:", error);
              alert(
                "There was a network error. Please check your connection and try again."
              );
            }
          });
      </script>
    </main>
  </body>
</html>
